matricoFoam is OpenFOAM solver (works on OF v. 2.1.0, but probably not only)
you can use it as template for discretization matrix coefficients extract.
